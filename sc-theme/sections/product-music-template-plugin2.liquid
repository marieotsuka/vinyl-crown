<div itemscope itemtype="http://schema.org/Product">
  
  <meta itemprop="url" content="{{ shop.url }}{{ product.url }}" />
  <meta itemprop="image" content="{{ product | img_url: 'grande' }}" />
  
  <form action="/cart/add" method="post" enctype="multipart/form-data">
    
    <section class="title">
      <h1>{{ product.title }}</h1>
      <h4>{{product.metafields.subtitle.album}}</h4>
    </section>
    <section class="hero">
      {% if product.images.size == 0 %}
        <img src="{{ '' | img_url: 'grande' }}" alt="" />
      {% else %} 
      {% assign featured_image = product.selected_or_first_available_variant.featured_image | default: product.featured_image %}
        <a href="{{ featured_image | img_url: '1024x1024' }}">
          <img src="{{ featured_image | img_url: 'grande' }}" alt="{{ product.title | escape }}" />
        </a>
        {% if product.images.size > 1 %}
          <ul>
            {% for image in product.images %}
              <li>
                <a href="{{ image | img_url: '1024x1024' }}">
                  <img src="{{ image | img_url: 'large' }}" alt="{{ image.alt | escape }}" />
                </a>
              </li>
            {% endfor %}
          </ul>
        {% endif %}
      {% endif %}
    </section>
      
    {% assign product_vendor_handle = product.vendor | handle %}
      {% comment %}
      Do we have a collection that has the same name as our product vendor name?
      If we do, let's have the vendor link point to it.
      If not, we will point to the automatic vendor collection.
     
      {% if collections[product_vendor_handle].handle == product_vendor_handle %}
        {% assign vendor_url = collections[product_vendor_handle].url %}
      {% else %}
        {% assign vendor_url = product.vendor | url_for_vendor %}
      {% endif %}
      <h2 itemprop="brand">{{ product.vendor | link_to: vendor_url }}</h2>
       {% endcomment %}


      <section itemprop="description">
        <div class="col-2">
          <div>
            {{ product.description}}
            <p class="subdescription">{{product.metafields.subdescription.album}}</p>
            <p class="san-serif">{{product.metafields.colophon.album}}</p>
          </div>
             {% comment %}
            {% if product.metafields.tracks.album != blank %}
            <div class="tracklist">
              {% assign tracklist = product.metafields.tracks.album %}
              <ul>
                {% for value in tracklist %}
                  {% assign i = forloop.index0 %}
                  <li class="item item--{{ i }}">
                     {{value[1]}}
                  </li>
               {% endfor %}
              </ul>
            </div>
            {% endif %}
                  {% endcomment %}

        </div>
        <div class="col-2">

            {% if product.metafields.credits.album != blank %}
              <table class="credit">
                <tbody>                
                {% assign credit_array = product.metafields.credits.album %}
                  {% for value in credit_array %}
                    {% assign i = forloop.index0 %}
                    <tr class="item item--{{ i }}">
                      <td>{{value[0]}}</td> 
                      <td>{{value[1]}}</td>
                    </tr>
                {% endfor %}
              </tbody>
              </table>
          {% endif %}

      <script>
        var obj = JSON.parse(localStorage.getItem("_myobject"));
        obj.map(function(item) { 
            // (really just the first key)
            for (var key in item) 
                return "Number: " + key + " - Time: " + item[key]; 
        }).join(" ");
      </script>
     

      {% comment %}
        All themes by Shopify should support the Product Reviews app out of the box.
        https://apps.shopify.com/product-reviews
      
      {% endcomment %}

      <div id="product-add">
        <input class="action" type="submit" name="add" id="add" value="Buy">
      </div>
      {% comment %}
      <div id="product-price" itemprop="offers" itemscope itemtype="http://schema.org/Offer">
        <meta itemprop="priceCurrency" content="{{ shop.currency }}" />
        {% if product.available %}
        <link itemprop="availability" href="http://schema.org/InStock" />
        {% else %}
        <link itemprop="availability" href="http://schema.org/OutOfStock" />
        {% endif %}
        <p>
          {% assign variant = product.selected_or_first_available_variant %}
          {% if product.compare_at_price > product.price %}
          <span class="product-price on-sale" itemprop="price">{{ variant.price | money }}</span>
          <s class="product-compare-price">{{ variant.compare_at_price | money }}</s>
          {% else %}
          <span class="product-price" itemprop="price">{{ variant.price | money }}</span>
          {% endif %}
        </p>
      </div>
       {% endcomment %}

      {% assign hide_default_title = false %}
      {% if product.variants.size == 1 and product.variants.first.title contains 'Default' %}
        {% assign hide_default_title = true %}
      {% endif %}       

      <div id="product-variants" class="{% if hide_default_title %} hidden{% endif %}">
        {% for variant in product.variants %}
        <ul>
          <li>{{ variant.title }}</li>
          <li class="san-serif">{{ variant.price | money }}</li>
          <li>    
            <input class="option" type="submit" name="add" id="add" value="Add">
          </li>
        </ul>
        

        {% endfor %}
        {% comment %}   
        <select id="product-select" name="id">
        {% for variant in product.variants %}
       
          <option{% if variant == product.selected_or_first_available_variant %} selected{% endif %} value="{{ variant.id }}">
          {{ variant.title }} - {{ variant.price | money }}
          </option>
               
        {% endfor %}
        </select>
        {% endcomment %}
      </div>        
             
      {% comment %}      
        <div id="backorder" class="hidden">
          <p>{{ '%s is back-ordered. We will ship it separately in 10 to 15 days.' | replace: '%s', '<span id="selected-variant"></span>' }}</p>
        </div>
      {% endcomment %}
        

       {% comment %}   
      {% if collection %}
        {% if collection.previous_product or collection.next_product %}
        <div>     
        {% if collection.previous_product %}
          {% capture prev_url %}{{ collection.previous_product}}#content{% endcapture %}
          <span class="left">{{ 'Previous Product' | link_to: prev_url }}</span>
        {% endif %}
        {% if collection.next_product %}
          {% capture next_url %}{{ collection.next_product}}#content{% endcapture %}
          <span class="right">{{ 'Next Product' | link_to: next_url }}</span>
        {% endif %}
        </div>
        {% endif %}
      {% endif %}
      {% endcomment %}
     </div>
    </section>
    <section class="video">
      <div class="video-container">
        <iframe src="{{product.metafields.url.video}}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
                
        {% if product.metafields.credits.video != blank %}
        <table class="credit video-credit">
          <tbody>
          {% assign credit_array = product.metafields.credits.video %}
            {% for value in credit_array %}
            <tr class="item item--{{ i }}">
              {% assign i = forloop.index0 %}
              <td>{{value[0]}}</td>
              <td>{{value[1]}}</td>
            </tr>
          {% endfor %}
         
          </tbody>
        </table>
    {% endif %}
    </section>

  </form>
  
  <div>{{ product.metafields.links.video }}</div>
  <div>{{ product.metafields.credit.video }}</div>

  {% if product.tags.size > 0 %}
     (related modules)
  {% endif %}

</div>